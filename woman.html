<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>三八妇女节快乐</title>
    <style>
        /* 保持原有样式不变 */
    </style>
</head>
<body>
    <div class="container">
        <h1>🌷 妇女节快乐 🌷</h1>
        
        <div class="flowers">
            <!-- 花朵由JS生成 -->
        </div>

        <div class="message">
            <p>亲爱的女性朋友们：</p>
            <p>愿你们眼中有光，心中有爱，</p>
            <p>活出自己最美的模样。</p>
            <p>感谢你们让世界更加温暖美好！</p>
            <p>💐 节日快乐 💐</p>
        </div>
    </div>

    <script>
        // 修复后的音乐播放逻辑
        let audio = null;
        let playButton = null;
        
        const initMusic = () => {
            // 更换为可靠的音乐链接（建议替换为自己的音乐文件）
            audio = new Audio('https://cdn.pixabay.com/audio/2022/03/08/audio_6b46dd5658.mp3');
            audio.volume = 0.3;
            
            // 预加载音乐
            audio.preload = 'auto';
            
            // 统一播放方法
            const playAudio = () => {
                audio.play()
                    .then(() => {
                        // 播放成功后移除按钮
                        if (playButton) {
                            playButton.remove();
                            playButton = null;
                        }
                    })
                    .catch((error) => {
                        console.log('播放失败:', error);
                        createPlayButton();
                    });
            };

            // 创建播放按钮（单例模式）
            const createPlayButton = () => {
                if (!playButton) {
                    playButton = document.createElement('button');
                    playButton.textContent = '🎵 点击播放音乐';
                    playButton.style.cssText = `
                        margin: 15px;
                        padding: 12px 24px;
                        border: none;
                        border-radius: 25px;
                        background: #ff4081;
                        color: white;
                        font-size: 1rem;
                    `;
                    playButton.addEventListener('click', () => {
                        playAudio();
                        playButton.blur(); // 移除点击后的焦点状态
                    });
                    document.querySelector('.container').appendChild(playButton);
                }
            };

            // 用户交互后初始化播放
            const startPlay = () => {
                try {
                    // 尝试自动播放
                    playAudio();
                } catch (error) {
                    createPlayButton();
                }
                // 移除事件监听（只执行一次）
                document.removeEventListener(triggerEvent, startPlay);
            };

            // 自动检测设备类型
            const triggerEvent = 'ontouchstart' in window ? 'touchstart' : 'click';
            document.addEventListener(triggerEvent, startPlay, { once: true });
        };

        // 其他原有代码保持不变...
        initMusic();
    </script>
</body>
</html>
